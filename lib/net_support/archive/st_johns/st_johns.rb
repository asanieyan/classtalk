Info = {
    :name=>"St. Johns",
    :nid=>"16777493",
    :city=>"queens",
    :region=>"new york",    
    :country=>"united states",
    :semesters=>[
      ["Fall","8/29", "12/20"],
      ["Spring","1/5", "5/15"],
      ["Summer I","6/1", "7/5"], 
      ["Summer II","7/7", "8/10"],
      ["Post Session","8/11", "8/21"]  
    ]
}          
class StJohnsParser < CourseParser
    
    def get_options_val(doc,id)
      opts = doc.at("##{id}").search("option")
      opts.shift;
      opts.map{|op| op['value']}      
    end
    def deserialize(query_string)
        hash = {}
        query_string.split("&").each do |k_v|
          k,v = k_v.split("=")
          hash[k] = v
        end
        return hash
    end
    def serialize_form(form,options={})
        values = options.delete(:values) || {}
        removes = options.delete(:removes)  || [] 
        unsafe =  options.delete(:unsafe)
        items = {}        
        %w(textarea input select).each do |item_str|
            form.search("#{item_str}").each do |item|
              if !removes.include? item['name']
                items[item['name']] = values[item['name']] || item['value'] || ""
              end             
            end
        end
        string = items.inject([]) { |a,hash|
                     k,v = hash
                      a << k + "=" + v   
                  }.join("&").gsub(/ /,'+')        
        return URI.encode(string,unsafe || URI::REGEXP::UNSAFE)
    end
    def do_post_back(form,link=nil,values={},remove=[])
        require 'uri'
        if link
          target,arg = link.slice(/\(.*?\)/).delete(")('").split(",")
          values =   {"__VIEWSTATE" => URI.encode(form.at('input[@name="__VIEWSTATE"]')['value'],/[\/+]/),          
                      "__EVENTARGUMENT" => arg || "",                     
                      "__EVENTTARGET" => target.split("$").join(":")}.merge(values)
                      
                   
        end          
        serialize_form(form,:removes=>["_ctl0:_ctl0:Footer1:butGo"]+remove,:values=>values,:unsafe=>/[:']/).gsub(/ /,'+')

    end
    def get_event_target(doc)           
          values = []
          doc.at("#Form1").search('input[@type="hidden"]').each do |input|
              values << input['name'] + "=" + input['value']
          end
          values.join("&")
          
    end  
    def compare(test,post1_hash,close_look="")            
            test = deserialize(test)
            post1_hash = deserialize(post1_hash)
            puts post1_hash.size
            puts test.size
            post1_hash.each do |name,value|
                 puts name
                 puts (test[name] || "").size
                 puts (value || "").size
                if name == close_look
                   tn = (test[name] || "")
                   pv = (value || "")
                   bigger = tn.size > pv.size ? tn : pv
                   bigger = tn
                   smaller = bigger == tn ? pv : tn
                  
                   bigger.size.times do |i|
                      bigger_ichar = bigger[i..i+1]
                      smaller_ichar = smaller[i..i+1]
                      if bigger_ichar != smaller_ichar
                          puts i
                          puts bigger_ichar
                          puts smaller_ichar 
                          raise                         
                      end
                   end
                  puts value
                  puts test[name]  
                end
            end 
    end  
    def start
        @sel_level = "_ctl0__ctl0__ctl0_dplLevel"        
        @sel_term  = "_ctl0__ctl0__ctl0_dplTerm"
        @dep = "_ctl0__ctl0__ctl0_pnlDepartment"
        @courses = "_ctl0__ctl0__ctl0__ctl0_DGCourses"
        
        campuses  = %w(Q)
        post_url = "http://www.stjohns.edu/view.aspx?path=academics&view=courses"
        csels = (main_doc = doc_at("http://www.stjohns.edu/academics/courses.stj")).search("li a")
        csels.pop
        csels.each do |dep|
            post1_val = do_post_back(main_doc.at("#Form1"),dep['href']) 
            school_doc = parse(post(post_url,post1_val))
            levels = get_options_val(school_doc,@sel_level)
            terms  = get_options_val(school_doc,@sel_term)            
            levels.each do |level|
                terms.each do |term|
                    campuses.each do |campus|                                                 
                         common = {
                          "__VIEWSTATE"=>"dDwtMTY5NDcyNjc0MTt0PDtsPGk8MT47aTwzPjtpPDU%2BO2k8Nz47aTw5PjtpPDExPjtpPDEzPjtpPDE1Pjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8U3QuIEpvaG4ncyBVbml2ZXJzaXR5IC0tIEFjYWRlbWljcyAmYW1wXDsgU2Nob29scyAtLSBDb3Vyc2VzIDs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0idGl0bGUiIGNvbnRlbnQ9IkNvdXJzZXMiXD5cPC9tZXRhXD4KCQlcPG1ldGEgbmFtZT0icHVibGljYXRpb25fZGF0ZSIgY29udGVudD0iMjAwNC0wMS0wNiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0ia2V5d29yZHMiIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy82XzUuY3NzIlw7CgkJCUBpbXBvcnQgImh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL1ByaW50L3ByaW50LmNzcyIgcHJpbnRcOwoJCQlAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy9QcmludC82XzUuY3NzIiBwcmludFw7Oz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8bGluayByZWw9InN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X3NtYWxsLmNzcyIgdGl0bGU9IlRleHQgc21hbGwiL1w%2BCgkJXDxsaW5rIHJlbD0iYWx0ZXJuYXRlIHN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X21lZGl1bS5jc3MiIHRpdGxlPSJUZXh0IG1lZGl1bSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfbGFyZ2UuY3NzIiB0aXRsZT0iVGV4dCBsYXJnZSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfeGxhcmdlLmNzcyIgdGl0bGU9IlRleHQgZXh0cmEtbGFyZ2UiL1w%2BOz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9qcXVlcnkuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BClw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9zanUuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BCjs%2BPjs7Pjt0PDtsPGk8MT47PjtsPHQ8O2w8aTw5Pjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BO2k8Mj47aTw0PjtpPDY%2BO2k8MTA%2BO2k8MTI%2BO2k8MTQ%2BO2k8MTY%2BO2k8MTg%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDwvOz4%2BOz47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9IZWFkZXIxX19jdGwwX0hlYWRlcl9jb2xsZWdlMV9YaW1hZ2UxIiBzcmM9Ii9pbWFnZXMvbG9nby5naWYiIGFsdD0iU3QuIEpvaG4ncyBVbml2ZXJzaXR5IiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDoxNTJweFw7IGhlaWdodDo5NXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8UHJvc3BlY3RpdmUgU3R1ZGVudHM7L3Byb3NwZWN0aXZlOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxTdHVkZW50czsvc3R1ZGVudHM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEZhY3VsdHkgJmFtcFw7IFN0YWZmOy9mYWN1bHR5Oz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBbHVtbmkgJmFtcFw7IEZyaWVuZHM7L2FsdW1uaTs%2BPjs%2BOzs%2BO3Q8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0hlYWRlcjFfX2N0bDBfSGVhZGVyX2NvbGxlZ2UxX2ltZ1N1YmhlYWQiIHNyYz0iL2ltYWdlcy9oZWFkZXIvc3BhY2VyLmdpZiIgYWx0PSIgIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47Pj47dDw7bDxpPDE%2BO2k8Mz47PjtsPHQ8O2w8aTwwPjtpPDE%2BO2k8Mj47aTwzPjtpPDQ%2BO2k8NT47aTw2PjtpPDc%2BOz47bDx0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEFib3V0IFN0LiBKb2huJ3M7L2Fib3V0Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvYWNhZGVtaWNzO0FjYWRlbWljcyAmYW1wXDsgU2Nob29sczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8QWRtaXNzaW9uOy9hZG1pc3Npb247Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPENhbXB1cyBMaWZlOy9jYW1wdXM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPFN0dWRlbnQgU2VydmljZXM7L3NlcnZpY2VzOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBdGhsZXRpY3M7L2F0aGxldGljczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8RXZlbnRzOy9ldmVudHMuc3RqOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxOZXdzOy9hYm91dC9uZXdzL2l0ZW1zOz4%2BOz47Oz47Pj47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwyPjs%2BO2w8dDxwPHA8bDxUZXh0O0Nzc0NsYXNzO18hU0I7PjtsPEFjYWRlbWljcyAmYW1wXDsgU2Nob29scztzZWxlY3RlZDtpPDI%2BOz4%2BOz47Oz47Pj47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47PjtsPHQ8cDxsPGlubmVyaHRtbDs%2BO2w8Q291cnNlcyA7Pj47Oz47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDxcZTs%2BPjs%2BO2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PHA8bDxUZXh0Oz47bDxcPGltZyBpZD0iX2N0bDBfX2N0bDBfR2l2aW5nQnV0dG9uMV9pbWdCdXR0b24iIHNyYz0iIiBhbHQ9IiIgc3R5bGU9ImJvcmRlci1zdHlsZTpub25lXDsgd2lkdGg6OThweFw7IGhlaWdodDoyMXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BOz4%2BOz4%2BO3Q8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDY%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxwPGw8Q3NzQ2xhc3M7XyFTQjs%2BO2w8U2luZ2xlSW1hZ2UxO2k8Mj47Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX1NpbmdsZUltYWdlMV9pbWdTaW5nbGUiIHNyYz0iL21lZGlhLzEvN2YwY2FhODJhNWUwNDk1MzlkZTc0ZmVjMDdlMTVhMjQuanBnIiBhbHQ9IiAiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7ICIgIC9cPjs%2BPjs7Pjs%2BPjs%2BPjs%2BPjt0PDtsPGk8MT47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDA%2BOz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BO2w8aTwxPjs%2BO2w8dDxwPHA8bDxOYXZpZ2F0ZVVybDs%2BO2w8XGU7Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0J1dHRvbkNvbnRyb2wxX2ltZ0J1dHRvbiIgc3JjPSIiIGFsdD0iIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDo5OHB4XDsgaGVpZ2h0OjIxcHhcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MT47aTw3PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BO2k8MTU%2BO2k8MTc%2BOz47bDx0PHA8cDxsPFRleHQ7PjtsPExpYmVyYWxBcnRzOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BOz47bDx0PHA8cDxsPFRleHQ7PjtsPFN0LiBKb2huJ3MgQ29sbGVnZSBvZiBMaWJlcmFsIEFydHMgYW5kIFNjaWVuY2VzOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BOz47bDx0PHQ8cDxwPGw8RGF0YVRleHRGaWVsZDtEYXRhVmFsdWVGaWVsZDs%2BO2w8TEVWTF9ERVNDO0xFVkw7Pj47Pjt0PGk8Mz47QDxTZWxlY3QgYSBsZXZlbC4uLjtHcmFkdWF0ZTtVbmRlcmdyYWR1YXRlOz47QDxcZTtHUjtVRzs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxURVJNX0NPREVfS0VZX0RFU0M7VEVSTV9DT0RFX0tFWTs%2BPjs%2BO3Q8aTw1PjtAPFNlbGVjdCBhIHRlcm0uLi47V2ludGVyIC0gMjAwNztTcHJpbmcgLSAyMDA3O1N1bW1lciAtIDIwMDc7RmFsbCAtIDIwMDc7PjtAPFxlOzIwMDcwNTsyMDA3MTA7MjAwNzMwOzIwMDc3MDs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxDQU1QX0RFU0M7Q0FNUF9DT0RFOz4%2BOz47dDxpPDk%2BO0A8U2VsZWN0IGEgY2FtcHVzLi4uO0Rpc3RhbmNlIExlYXJuaW5nICAgICAgICAgICAgIDtNYW5oYXR0YW4gQ2FtcHVzICAgICAgICAgICAgICA7T2FrZGFsZSBDYW1wdXMgICAgICAgICAgICAgICAgO09mZi1DYW1wdXMgICAgICAgICAgICAgICAgICAgIDtRdWVlbnMgQ2FtcHVzICAgICAgICAgICAgICAgICA7Um9tZSBDYW1wdXMgICAgICAgICAgICAgICAgICAgO1N0YXRlbiBJc2xhbmQgQ2FtcHVzICAgICAgICAgIDtTdHVkeSBBYnJvYWQgICAgICAgICAgICAgICAgICA7PjtAPFxlO0Q7TTtFO087UTtSO1M7QTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDs%2BO2w8XDxlbVw%2BKFRoZSBjb3Vyc2UgbGlzdGluZ3Mgd2VyZSBsYXN0IHVwZGF0ZWQgb24gU2VwdGVtYmVyIDE5LCAyMDA3LilcPC9lbVw%2BXDxici9cPlw8YnIvXD5Gb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgY29tbW9uIGFuZCBkaXN0cmlidXRlZCBjb3JlIGN1cnJpY3VsdW0gYW5kIHRoZSByZXF1aXJlbWVudHMgZm9yIHlvdXIgcHJvZ3JhbSwgXDxhIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvYWNhZGVtaWNzL3Byb3Zvc3QvY29yZS9jb3JlLnN0aiJcPmNsaWNrIGhlcmVcPC9hXD4uXDxici9cPlw8YnIvXD4KOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDM%2BOz47bDx0PEAwPDs7Ozs7Ozs7Pjs7Pjs%2BPjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Pjs7Pjs%2BPjs%2BPjs%2BPjs%2BPjt0PDtsPGk8MT47aTw1PjtpPDc%2BO2k8OT47aTwxMD47aTwxND47aTwxNj47aTwxOD47PjtsPHQ8cDw7cDxsPHNpemU7b25mb2N1cztvbmJsdXI7b25rZXlkb3duOz47bDwxMjtpZiAodGhpcy52YWx1ZSA9PSAnU2VhcmNoIFN0LiBKb2huXFwncycpIHRoaXMudmFsdWUgPSAnJ1w7O2lmICh0aGlzLnZhbHVlID09ICcnKSB0aGlzLnZhbHVlID0gJ1NlYXJjaCBTdC4gSm9oblxcJ3MnXDs7aWYgKChldmVudC53aGljaCAmJiBldmVudC53aGljaCA9PSAxMykgfHwgKGV2ZW50LmtleUNvZGUgJiYgZXZlbnQua2V5Q29kZSA9PSAxMykpIHt0aGlzLmZvcm0uZWxlbWVudHNbJ19jdGwwOl9jdGwwOkZvb3RlcjE6YnV0R28nXS5jbGljaygpXDtyZXR1cm4gZmFsc2VcO30gZWxzZSByZXR1cm4gdHJ1ZVw7IDs%2BPj47Oz47dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDc%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC91aXM7TG9naW4gVUlTOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc3R1ZGVudHMvaW50cmFuZXQuc3RqO1N0LiBKb2huJ3MgSW50cmFuZXQ7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9jb250YWN0LnN0ajtDb250YWN0IFVzOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvYWx1bW5pL2dpdmluZztHaXZpbmcgQmFjazs%2BPjs%2BOzs%2BOz4%2BO3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDs%2BO2w8LyM7Pj47cDxsPG9uY2xpY2s7PjtsPHdpbmRvdy5vcGVuKCdodHRwOi8vd3d3LnN0am9obnMuZWR1L2FjYWRlbWljcy9jb3Vyc2VzLnByaW50JywncHJpbnQnLCd3aWR0aD01MDAsaGVpZ2h0PTUwMCxyZXNpemFibGU9eWVzLHNjcm9sbGJhcnM9eWVzLHRvb2xiYXI9eWVzLG1lbnViYXI9eWVzJylcO3JldHVybiBmYWxzZVw7Oz4%2BPjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0Zvb3RlcjFfaW1nUHJpbnQiIHNyYz0iL2ltYWdlcy9mb290ZXIvcHJpbnRJY29uLmdpZiIgYWx0PSJQcmludCIgc3R5bGU9ImJvcmRlci1zdHlsZTpub25lXDsgd2lkdGg6MjBweFw7IGhlaWdodDoxMHB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7PjtsPC8jOz4%2BO3A8bDxvbmNsaWNrOz47bDx3aW5kb3cub3BlbigibWFpbHRvOj9TdWJqZWN0PUludGVyZXN0aW5nJTIwaXRlbSUyMGZyb20lMjBTdC4lMjBKb2huJ3MuLi4mQm9keT1JJTIwc2F3JTIwdGhpcyUyMHBhZ2UlMjBvbiUyMHRoZSUyMFN0LiUyMEpvaG4ncyUyMFVuaXZlcnNpdHklMjBXZWIlMjBzaXRlLCUyMGFuZCUyMHRob3VnaHQlMjB5b3UlMjBtaWdodCUyMGJlJTIwaW50ZXJlc3RlZDolMGElMGFodHRwJTNhJTJmJTJmd3d3LnN0am9obnMuZWR1JTJmYWNhZGVtaWNzJTJmY291cnNlcy5zdGoiLCdtYWlsYWZyaWVuZCcsJycpXDtyZXR1cm4gZmFsc2VcOzs%2BPj47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9Gb290ZXIxX2ltZ0VtYWlsIiBzcmM9Ii9pbWFnZXMvZm9vdGVyL2VtYWlsSWNvbi5naWYiIGFsdD0iRS1tYWlsIHBhZ2UiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7IHdpZHRoOjI4cHhcOyBoZWlnaHQ6OHB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxsPFRleHQ7PjtsPDIwMDc7Pj47Oz47dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDc%2BO2k8OT47aTwxMT47aTwxMz47aTwxNT47PjtsPHQ8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8LztIb21lOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc2l0ZW1hcC5zdGo7U2l0ZSBNYXA7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPG1haWx0bzp3ZWJtYXN0ZXJAc3Rqb2hucy5lZHU%2FU3ViamVjdD1TaXRlJTIwRmVlZGJhY2s7RmVlZGJhY2s7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9wcml2YWN5LnN0ajtQcml2YWN5Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc2FmZXR5O1NhZmV0eTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L3N0dWRlbnRzL3Nob3Auc3RqO1Nob3AgU3QuIEpvaG4nczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L2ZhY3VsdHkvaHIvcmVjcnVpdG1lbnQ7V29yayBhdCBTdC4gSm9obidzOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvZmFjdWx0eS9ocjtIdW1hbiBSZXNvdXJjZXM7Pj47Pjs7Pjs%2BPjt0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOzs%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%3D",
                          "_ctl0:_ctl0:_ctl0:dplLevel"=>level,
                          "_ctl0:_ctl0:_ctl0:dplTerm" => term,
                          "_ctl0:_ctl0:_ctl0:dplCampus" =>campus                         
                         }                          
                         post2_val = do_post_back(school_doc.at("#Form1"),nil,common)                         
                         test = "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=dDwtMTY5NDcyNjc0MTt0PDtsPGk8MT47aTwzPjtpPDU%2BO2k8Nz47aTw5PjtpPDExPjtpPDEzPjtpPDE1Pjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8U3QuIEpvaG4ncyBVbml2ZXJzaXR5IC0tIEFjYWRlbWljcyAmYW1wXDsgU2Nob29scyAtLSBDb3Vyc2VzIDs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0idGl0bGUiIGNvbnRlbnQ9IkNvdXJzZXMiXD5cPC9tZXRhXD4KCQlcPG1ldGEgbmFtZT0icHVibGljYXRpb25fZGF0ZSIgY29udGVudD0iMjAwNC0wMS0wNiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0ia2V5d29yZHMiIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy82XzUuY3NzIlw7CgkJCUBpbXBvcnQgImh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL1ByaW50L3ByaW50LmNzcyIgcHJpbnRcOwoJCQlAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy9QcmludC82XzUuY3NzIiBwcmludFw7Oz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8bGluayByZWw9InN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X3NtYWxsLmNzcyIgdGl0bGU9IlRleHQgc21hbGwiL1w%2BCgkJXDxsaW5rIHJlbD0iYWx0ZXJuYXRlIHN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X21lZGl1bS5jc3MiIHRpdGxlPSJUZXh0IG1lZGl1bSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfbGFyZ2UuY3NzIiB0aXRsZT0iVGV4dCBsYXJnZSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfeGxhcmdlLmNzcyIgdGl0bGU9IlRleHQgZXh0cmEtbGFyZ2UiL1w%2BOz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9qcXVlcnkuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BClw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9zanUuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BCjs%2BPjs7Pjt0PDtsPGk8MT47PjtsPHQ8O2w8aTw5Pjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BO2k8Mj47aTw0PjtpPDY%2BO2k8MTA%2BO2k8MTI%2BO2k8MTQ%2BO2k8MTY%2BO2k8MTg%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDwvOz4%2BOz47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9IZWFkZXIxX19jdGwwX0hlYWRlcl9jb2xsZWdlMV9YaW1hZ2UxIiBzcmM9Ii9pbWFnZXMvbG9nby5naWYiIGFsdD0iU3QuIEpvaG4ncyBVbml2ZXJzaXR5IiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDoxNTJweFw7IGhlaWdodDo5NXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8UHJvc3BlY3RpdmUgU3R1ZGVudHM7L3Byb3NwZWN0aXZlOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxTdHVkZW50czsvc3R1ZGVudHM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEZhY3VsdHkgJmFtcFw7IFN0YWZmOy9mYWN1bHR5Oz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBbHVtbmkgJmFtcFw7IEZyaWVuZHM7L2FsdW1uaTs%2BPjs%2BOzs%2BO3Q8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0hlYWRlcjFfX2N0bDBfSGVhZGVyX2NvbGxlZ2UxX2ltZ1N1YmhlYWQiIHNyYz0iL2ltYWdlcy9oZWFkZXIvc3BhY2VyLmdpZiIgYWx0PSIgIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47Pj47dDw7bDxpPDE%2BO2k8Mz47PjtsPHQ8O2w8aTwwPjtpPDE%2BO2k8Mj47aTwzPjtpPDQ%2BO2k8NT47aTw2PjtpPDc%2BOz47bDx0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEFib3V0IFN0LiBKb2huJ3M7L2Fib3V0Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvYWNhZGVtaWNzO0FjYWRlbWljcyAmYW1wXDsgU2Nob29sczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8QWRtaXNzaW9uOy9hZG1pc3Npb247Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPENhbXB1cyBMaWZlOy9jYW1wdXM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPFN0dWRlbnQgU2VydmljZXM7L3NlcnZpY2VzOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBdGhsZXRpY3M7L2F0aGxldGljczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8RXZlbnRzOy9ldmVudHMuc3RqOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxOZXdzOy9hYm91dC9uZXdzL2l0ZW1zOz4%2BOz47Oz47Pj47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwyPjs%2BO2w8dDxwPHA8bDxUZXh0O0Nzc0NsYXNzO18hU0I7PjtsPEFjYWRlbWljcyAmYW1wXDsgU2Nob29scztzZWxlY3RlZDtpPDI%2BOz4%2BOz47Oz47Pj47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47PjtsPHQ8cDxsPGlubmVyaHRtbDs%2BO2w8Q291cnNlcyA7Pj47Oz47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDxcZTs%2BPjs%2BO2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PHA8bDxUZXh0Oz47bDxcPGltZyBpZD0iX2N0bDBfX2N0bDBfR2l2aW5nQnV0dG9uMV9pbWdCdXR0b24iIHNyYz0iIiBhbHQ9IiIgc3R5bGU9ImJvcmRlci1zdHlsZTpub25lXDsgd2lkdGg6OThweFw7IGhlaWdodDoyMXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BOz4%2BOz4%2BO3Q8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDY%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxwPGw8Q3NzQ2xhc3M7XyFTQjs%2BO2w8U2luZ2xlSW1hZ2UxO2k8Mj47Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX1NpbmdsZUltYWdlMV9pbWdTaW5nbGUiIHNyYz0iL21lZGlhLzEvN2YwY2FhODJhNWUwNDk1MzlkZTc0ZmVjMDdlMTVhMjQuanBnIiBhbHQ9IiAiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7ICIgIC9cPjs%2BPjs7Pjs%2BPjs%2BPjs%2BPjt0PDtsPGk8MT47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDA%2BOz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BO2w8aTwxPjs%2BO2w8dDxwPHA8bDxOYXZpZ2F0ZVVybDs%2BO2w8XGU7Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0J1dHRvbkNvbnRyb2wxX2ltZ0J1dHRvbiIgc3JjPSIiIGFsdD0iIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDo5OHB4XDsgaGVpZ2h0OjIxcHhcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MT47aTw3PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BO2k8MTU%2BO2k8MTc%2BOz47bDx0PHA8cDxsPFRleHQ7PjtsPExpYmVyYWxBcnRzOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BOz47bDx0PHA8cDxsPFRleHQ7PjtsPFN0LiBKb2huJ3MgQ29sbGVnZSBvZiBMaWJlcmFsIEFydHMgYW5kIFNjaWVuY2VzOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BOz47bDx0PHQ8cDxwPGw8RGF0YVRleHRGaWVsZDtEYXRhVmFsdWVGaWVsZDs%2BO2w8TEVWTF9ERVNDO0xFVkw7Pj47Pjt0PGk8Mz47QDxTZWxlY3QgYSBsZXZlbC4uLjtHcmFkdWF0ZTtVbmRlcmdyYWR1YXRlOz47QDxcZTtHUjtVRzs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxURVJNX0NPREVfS0VZX0RFU0M7VEVSTV9DT0RFX0tFWTs%2BPjs%2BO3Q8aTw1PjtAPFNlbGVjdCBhIHRlcm0uLi47V2ludGVyIC0gMjAwNztTcHJpbmcgLSAyMDA3O1N1bW1lciAtIDIwMDc7RmFsbCAtIDIwMDc7PjtAPFxlOzIwMDcwNTsyMDA3MTA7MjAwNzMwOzIwMDc3MDs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxDQU1QX0RFU0M7Q0FNUF9DT0RFOz4%2BOz47dDxpPDk%2BO0A8U2VsZWN0IGEgY2FtcHVzLi4uO0Rpc3RhbmNlIExlYXJuaW5nICAgICAgICAgICAgIDtNYW5oYXR0YW4gQ2FtcHVzICAgICAgICAgICAgICA7T2FrZGFsZSBDYW1wdXMgICAgICAgICAgICAgICAgO09mZi1DYW1wdXMgICAgICAgICAgICAgICAgICAgIDtRdWVlbnMgQ2FtcHVzICAgICAgICAgICAgICAgICA7Um9tZSBDYW1wdXMgICAgICAgICAgICAgICAgICAgO1N0YXRlbiBJc2xhbmQgQ2FtcHVzICAgICAgICAgIDtTdHVkeSBBYnJvYWQgICAgICAgICAgICAgICAgICA7PjtAPFxlO0Q7TTtFO087UTtSO1M7QTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDs%2BO2w8XDxlbVw%2BKFRoZSBjb3Vyc2UgbGlzdGluZ3Mgd2VyZSBsYXN0IHVwZGF0ZWQgb24gU2VwdGVtYmVyIDE5LCAyMDA3LilcPC9lbVw%2BXDxici9cPlw8YnIvXD5Gb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgY29tbW9uIGFuZCBkaXN0cmlidXRlZCBjb3JlIGN1cnJpY3VsdW0gYW5kIHRoZSByZXF1aXJlbWVudHMgZm9yIHlvdXIgcHJvZ3JhbSwgXDxhIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvYWNhZGVtaWNzL3Byb3Zvc3QvY29yZS9jb3JlLnN0aiJcPmNsaWNrIGhlcmVcPC9hXD4uXDxici9cPlw8YnIvXD4KOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDM%2BOz47bDx0PEAwPDs7Ozs7Ozs7Pjs7Pjs%2BPjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Pjs7Pjs%2BPjs%2BPjs%2BPjs%2BPjt0PDtsPGk8MT47aTw1PjtpPDc%2BO2k8OT47aTwxMD47aTwxND47aTwxNj47aTwxOD47PjtsPHQ8cDw7cDxsPHNpemU7b25mb2N1cztvbmJsdXI7b25rZXlkb3duOz47bDwxMjtpZiAodGhpcy52YWx1ZSA9PSAnU2VhcmNoIFN0LiBKb2huXFwncycpIHRoaXMudmFsdWUgPSAnJ1w7O2lmICh0aGlzLnZhbHVlID09ICcnKSB0aGlzLnZhbHVlID0gJ1NlYXJjaCBTdC4gSm9oblxcJ3MnXDs7aWYgKChldmVudC53aGljaCAmJiBldmVudC53aGljaCA9PSAxMykgfHwgKGV2ZW50LmtleUNvZGUgJiYgZXZlbnQua2V5Q29kZSA9PSAxMykpIHt0aGlzLmZvcm0uZWxlbWVudHNbJ19jdGwwOl9jdGwwOkZvb3RlcjE6YnV0R28nXS5jbGljaygpXDtyZXR1cm4gZmFsc2VcO30gZWxzZSByZXR1cm4gdHJ1ZVw7IDs%2BPj47Oz47dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDc%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC91aXM7TG9naW4gVUlTOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc3R1ZGVudHMvaW50cmFuZXQuc3RqO1N0LiBKb2huJ3MgSW50cmFuZXQ7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9jb250YWN0LnN0ajtDb250YWN0IFVzOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvYWx1bW5pL2dpdmluZztHaXZpbmcgQmFjazs%2BPjs%2BOzs%2BOz4%2BO3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDs%2BO2w8LyM7Pj47cDxsPG9uY2xpY2s7PjtsPHdpbmRvdy5vcGVuKCdodHRwOi8vd3d3LnN0am9obnMuZWR1L2FjYWRlbWljcy9jb3Vyc2VzLnByaW50JywncHJpbnQnLCd3aWR0aD01MDAsaGVpZ2h0PTUwMCxyZXNpemFibGU9eWVzLHNjcm9sbGJhcnM9eWVzLHRvb2xiYXI9eWVzLG1lbnViYXI9eWVzJylcO3JldHVybiBmYWxzZVw7Oz4%2BPjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0Zvb3RlcjFfaW1nUHJpbnQiIHNyYz0iL2ltYWdlcy9mb290ZXIvcHJpbnRJY29uLmdpZiIgYWx0PSJQcmludCIgc3R5bGU9ImJvcmRlci1zdHlsZTpub25lXDsgd2lkdGg6MjBweFw7IGhlaWdodDoxMHB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7PjtsPC8jOz4%2BO3A8bDxvbmNsaWNrOz47bDx3aW5kb3cub3BlbigibWFpbHRvOj9TdWJqZWN0PUludGVyZXN0aW5nJTIwaXRlbSUyMGZyb20lMjBTdC4lMjBKb2huJ3MuLi4mQm9keT1JJTIwc2F3JTIwdGhpcyUyMHBhZ2UlMjBvbiUyMHRoZSUyMFN0LiUyMEpvaG4ncyUyMFVuaXZlcnNpdHklMjBXZWIlMjBzaXRlLCUyMGFuZCUyMHRob3VnaHQlMjB5b3UlMjBtaWdodCUyMGJlJTIwaW50ZXJlc3RlZDolMGElMGFodHRwJTNhJTJmJTJmd3d3LnN0am9obnMuZWR1JTJmYWNhZGVtaWNzJTJmY291cnNlcy5zdGoiLCdtYWlsYWZyaWVuZCcsJycpXDtyZXR1cm4gZmFsc2VcOzs%2BPj47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9Gb290ZXIxX2ltZ0VtYWlsIiBzcmM9Ii9pbWFnZXMvZm9vdGVyL2VtYWlsSWNvbi5naWYiIGFsdD0iRS1tYWlsIHBhZ2UiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7IHdpZHRoOjI4cHhcOyBoZWlnaHQ6OHB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxsPFRleHQ7PjtsPDIwMDc7Pj47Oz47dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDc%2BO2k8OT47aTwxMT47aTwxMz47aTwxNT47PjtsPHQ8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8LztIb21lOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc2l0ZW1hcC5zdGo7U2l0ZSBNYXA7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPG1haWx0bzp3ZWJtYXN0ZXJAc3Rqb2hucy5lZHU%2FU3ViamVjdD1TaXRlJTIwRmVlZGJhY2s7RmVlZGJhY2s7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9wcml2YWN5LnN0ajtQcml2YWN5Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvc2FmZXR5O1NhZmV0eTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L3N0dWRlbnRzL3Nob3Auc3RqO1Nob3AgU3QuIEpvaG4nczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L2ZhY3VsdHkvaHIvcmVjcnVpdG1lbnQ7V29yayBhdCBTdC4gSm9obidzOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvZmFjdWx0eS9ocjtIdW1hbiBSZXNvdXJjZXM7Pj47Pjs7Pjs%2BPjt0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOzs%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%2BOz4%3D&_ctl0%3A_ctl0%3A_ctl0%3AdplLevel=GR&_ctl0%3A_ctl0%3A_ctl0%3AdplTerm=200710&_ctl0%3A_ctl0%3A_ctl0%3AdplCampus=Q&_ctl0%3A_ctl0%3A_ctl0%3AButton1=Submit&_ctl0%3A_ctl0%3AFooter1%3ATextBoxQ=Search+St.+John%27s"
                         deps_doc_main = parse(post(post_url,post2_val))
                         deps_doc = deps_doc_main.at("##{@dep}")                         
                         begin
                           x =  level + " " + term + " " + campus
                           filters = ["UG 200710 Q","UG 200730 Q"]
                           if term == "200770" || filters.include?(x)
                              next
                           elsif deps_doc.to_html =~ /Please try again/
                             puts "No Subjects"
                             next  
                           end
                         rescue Exception=>e
                            next
                         end
                         subjects = deps_doc.search("a")
                         puts "#{subjects.size} subjects"
                         subjects.each do |s_link|                            
                            s_name = s_link.inner_text 
                            s_code = s_name.slice!(/\(.*?\)/)
                            s_code.delete!("()")
                            get_subject(s_code,s_name)
                            common.update("__VIEWSTATE"=>"dDwtMTY5NDcyNjc0MTt0PDtsPGk8MT47aTwzPjtpPDU%2BO2k8Nz47aTw5PjtpPDExPjtpPDEzPjtpPDE1Pjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8U3QuIEpvaG4ncyBVbml2ZXJzaXR5IC0tIEFjYWRlbWljcyAmYW1wXDsgU2Nob29scyAtLSBDb3Vyc2VzIDs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0idGl0bGUiIGNvbnRlbnQ9IkNvdXJzZXMiXD5cPC9tZXRhXD4KCQlcPG1ldGEgbmFtZT0icHVibGljYXRpb25fZGF0ZSIgY29udGVudD0iMjAwNC0wMS0wNiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0ia2V5d29yZHMiIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxcPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IiJcPlw8L21ldGFcPjs%2BPjs7Pjt0PHA8bDxUZXh0Oz47bDxAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy82XzUuY3NzIlw7CgkJCUBpbXBvcnQgImh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL1ByaW50L3ByaW50LmNzcyIgcHJpbnRcOwoJCQlAaW1wb3J0ICJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy9QcmludC82XzUuY3NzIiBwcmludFw7Oz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8bGluayByZWw9InN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X3NtYWxsLmNzcyIgdGl0bGU9IlRleHQgc21hbGwiL1w%2BCgkJXDxsaW5rIHJlbD0iYWx0ZXJuYXRlIHN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSJodHRwOi8vd3d3LnN0am9obnMuZWR1L1RoZW1lcy8xL0NTUy90ZXh0X21lZGl1bS5jc3MiIHRpdGxlPSJUZXh0IG1lZGl1bSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfbGFyZ2UuY3NzIiB0aXRsZT0iVGV4dCBsYXJnZSIvXD4KCQlcPGxpbmsgcmVsPSJhbHRlcm5hdGUgc3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvVGhlbWVzLzEvQ1NTL3RleHRfeGxhcmdlLmNzcyIgdGl0bGU9IlRleHQgZXh0cmEtbGFyZ2UiL1w%2BOz4%2BOzs%2BO3Q8cDxsPFRleHQ7PjtsPFw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9qcXVlcnkuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BClw8c2NyaXB0IHNyYz0iaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9zanUuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCJcPlw8L3NjcmlwdFw%2BCjs%2BPjs7Pjt0PDtsPGk8MT47PjtsPHQ8O2w8aTw5Pjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BO2k8Mj47aTw0PjtpPDY%2BO2k8MTA%2BO2k8MTI%2BO2k8MTQ%2BO2k8MTY%2BO2k8MTg%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDwvOz4%2BOz47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9IZWFkZXIxX19jdGwwX0hlYWRlcl9jb2xsZWdlMV9YaW1hZ2UxIiBzcmM9Ii9pbWFnZXMvbG9nby5naWYiIGFsdD0iU3QuIEpvaG4ncyBVbml2ZXJzaXR5IiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDoxNTJweFw7IGhlaWdodDo5NXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8UHJvc3BlY3RpdmUgU3R1ZGVudHM7L3Byb3NwZWN0aXZlOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxTdHVkZW50czsvc3R1ZGVudHM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEZhY3VsdHkgJmFtcFw7IFN0YWZmOy9mYWN1bHR5Oz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBbHVtbmkgJmFtcFw7IEZyaWVuZHM7L2FsdW1uaTs%2BPjs%2BOzs%2BO3Q8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0hlYWRlcjFfX2N0bDBfSGVhZGVyX2NvbGxlZ2UxX2ltZ1N1YmhlYWQiIHNyYz0iL2ltYWdlcy9oZWFkZXIvc3BhY2VyLmdpZiIgYWx0PSIgIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47Pj47dDw7bDxpPDE%2BO2k8Mz47PjtsPHQ8O2w8aTwwPjtpPDE%2BO2k8Mj47aTwzPjtpPDQ%2BO2k8NT47aTw2PjtpPDc%2BOz47bDx0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPEFib3V0IFN0LiBKb2huJ3M7L2Fib3V0Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvYWNhZGVtaWNzO0FjYWRlbWljcyAmYW1wXDsgU2Nob29sczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8QWRtaXNzaW9uOy9hZG1pc3Npb247Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPENhbXB1cyBMaWZlOy9jYW1wdXM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7TmF2aWdhdGVVcmw7PjtsPFN0dWRlbnQgU2VydmljZXM7L3NlcnZpY2VzOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxBdGhsZXRpY3M7L2F0aGxldGljczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDtOYXZpZ2F0ZVVybDs%2BO2w8RXZlbnRzOy9ldmVudHMuc3RqOz4%2BOz47Oz47dDxwPHA8bDxUZXh0O05hdmlnYXRlVXJsOz47bDxOZXdzOy9hYm91dC9uZXdzL2l0ZW1zOz4%2BOz47Oz47Pj47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwyPjs%2BO2w8dDxwPHA8bDxUZXh0O0Nzc0NsYXNzO18hU0I7PjtsPEFjYWRlbWljcyAmYW1wXDsgU2Nob29scztzZWxlY3RlZDtpPDI%2BOz4%2BOz47Oz47Pj47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47PjtsPHQ8cDxsPGlubmVyaHRtbDs%2BO2w8Q291cnNlcyA7Pj47Oz47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDxcZTs%2BPjs%2BO2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PHA8bDxUZXh0Oz47bDxcPGltZyBpZD0iX2N0bDBfX2N0bDBfR2l2aW5nQnV0dG9uMV9pbWdCdXR0b24iIHNyYz0iIiBhbHQ9IiIgc3R5bGU9ImJvcmRlci1zdHlsZTpub25lXDsgd2lkdGg6OThweFw7IGhlaWdodDoyMXB4XDsgIiAgL1w%2BOz4%2BOzs%2BOz4%2BOz4%2BOz4%2BOz4%2BO3Q8O2w8aTwwPjs%2BO2w8dDw7bDxpPDE%2BO2k8Mz47aTw1PjtpPDY%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxwPGw8Q3NzQ2xhc3M7XyFTQjs%2BO2w8U2luZ2xlSW1hZ2UxO2k8Mj47Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX1NpbmdsZUltYWdlMV9pbWdTaW5nbGUiIHNyYz0iL21lZGlhLzEvN2YwY2FhODJhNWUwNDk1MzlkZTc0ZmVjMDdlMTVhMjQuanBnIiBhbHQ9IiAiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7ICIgIC9cPjs%2BPjs7Pjs%2BPjs%2BPjs%2BPjt0PDtsPGk8MT47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47bDxpPDA%2BOz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BO2w8aTwxPjs%2BO2w8dDxwPHA8bDxOYXZpZ2F0ZVVybDs%2BO2w8XGU7Pj47PjtsPGk8MD47PjtsPHQ8O2w8aTwwPjs%2BO2w8dDxwPGw8VGV4dDs%2BO2w8XDxpbWcgaWQ9Il9jdGwwX19jdGwwX0J1dHRvbkNvbnRyb2wxX2ltZ0J1dHRvbiIgc3JjPSIiIGFsdD0iIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDo5OHB4XDsgaGVpZ2h0OjIxcHhcOyAiICAvXD47Pj47Oz47Pj47Pj47Pj47Pj47dDw7bDxpPDA%2BOz47bDx0PDtsPGk8MT47aTwyPjtpPDM%2BO2k8ND47aTw1PjtpPDc%2BO2k8OT47aTwxMT47aTwxMz47aTwxNT47aTwxNz47PjtsPHQ8cDxwPGw8VGV4dDs%2BO2w8TGliZXJhbEFydHM7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7PjtsPEdSOz4%2BOz47Oz47dDxwPHA8bDxUZXh0Oz47bDwyMDA3MTA7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7PjtsPFE7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7PjtsPFxlOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BOz47bDx0PHA8cDxsPFRleHQ7PjtsPFN0LiBKb2huJ3MgQ29sbGVnZSBvZiBMaWJlcmFsIEFydHMgYW5kIFNjaWVuY2VzOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47aTw1PjtpPDk%2BOz47bDx0PHQ8cDxwPGw8RGF0YVRleHRGaWVsZDtEYXRhVmFsdWVGaWVsZDs%2BO2w8TEVWTF9ERVNDO0xFVkw7Pj47Pjt0PGk8Mz47QDxTZWxlY3QgYSBsZXZlbC4uLjtHcmFkdWF0ZTtVbmRlcmdyYWR1YXRlOz47QDxcZTtHUjtVRzs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxURVJNX0NPREVfS0VZX0RFU0M7VEVSTV9DT0RFX0tFWTs%2BPjs%2BO3Q8aTw1PjtAPFNlbGVjdCBhIHRlcm0uLi47V2ludGVyIC0gMjAwNztTcHJpbmcgLSAyMDA3O1N1bW1lciAtIDIwMDc7RmFsbCAtIDIwMDc7PjtAPFxlOzIwMDcwNTsyMDA3MTA7MjAwNzMwOzIwMDc3MDs%2BPjs%2BOzs%2BO3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxDQU1QX0RFU0M7Q0FNUF9DT0RFOz4%2BOz47dDxpPDk%2BO0A8U2VsZWN0IGEgY2FtcHVzLi4uO0Rpc3RhbmNlIExlYXJuaW5nICAgICAgICAgICAgIDtNYW5oYXR0YW4gQ2FtcHVzICAgICAgICAgICAgICA7T2FrZGFsZSBDYW1wdXMgICAgICAgICAgICAgICAgO09mZi1DYW1wdXMgICAgICAgICAgICAgICAgICAgIDtRdWVlbnMgQ2FtcHVzICAgICAgICAgICAgICAgICA7Um9tZSBDYW1wdXMgICAgICAgICAgICAgICAgICAgO1N0YXRlbiBJc2xhbmQgQ2FtcHVzICAgICAgICAgIDtTdHVkeSBBYnJvYWQgICAgICAgICAgICAgICAgICA7PjtAPFxlO0Q7TTtFO087UTtSO1M7QTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8VGV4dDs%2BO2w8XDxlbVw%2BKFRoZSBjb3Vyc2UgbGlzdGluZ3Mgd2VyZSBsYXN0IHVwZGF0ZWQgb24gU2VwdGVtYmVyIDE5LCAyMDA3LilcPC9lbVw%2BXDxici9cPlw8YnIvXD5Gb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgY29tbW9uIGFuZCBkaXN0cmlidXRlZCBjb3JlIGN1cnJpY3VsdW0gYW5kIHRoZSByZXF1aXJlbWVudHMgZm9yIHlvdXIgcHJvZ3JhbSwgXDxhIGhyZWY9Imh0dHA6Ly93d3cuc3Rqb2hucy5lZHUvYWNhZGVtaWNzL3Byb3Zvc3QvY29yZS9jb3JlLnN0aiJcPmNsaWNrIGhlcmVcPC9hXD4uXDxici9cPlw8YnIvXD4KOz4%2BOz47Oz47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPHQ%2BOz4%2BOz47bDxpPDE%2BO2k8Mz47PjtsPHQ8cDxwPGw8VGV4dDs%2BO2w8XGU7Pj47Pjs7Pjt0PEAwPHA8cDxsPERhdGFLZXlzO18hSXRlbUNvdW50Oz47bDxsPEFTQyA7QklPIDtDSEUgO0NISSA7Q1JNIDtFTkcgO0dPViA7SElTIDtNTFMgO0xJUyA7TVRIIDtQU1kgO1NPQyA7U1BBIDtTUEUgO1RIRSA7PjtpPDE2Pjs%2BPjs%2BOzs7Ozs7Ozs%2BO2w8aTwwPjtpPDE%2BO2k8Mj47aTwzPjtpPDQ%2BO2k8NT47aTw2PjtpPDc%2BO2k8OD47aTw5PjtpPDEwPjtpPDExPjtpPDEyPjtpPDEzPjtpPDE0PjtpPDE1Pjs%2BO2w8dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxBU0lBTiBTVFVESUVTICAgICAgICAgICAgICAgICAgKEFTQyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxCSU9MT0dZICAgICAgICAgICAgICAgICAgICAgICAgKEJJTyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxDSEVNSVNUUlkgICAgICAgICAgICAgICAgICAgICAgKENIRSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxDSElORVNFICAgICAgICAgICAgICAgICAgICAgICAgKENISSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxDUklNSU5PTE9HWSAgICAgICAgICAgICAgICAgICAgKENSTSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxFTkdMSVNIICAgICAgICAgICAgICAgICAgICAgICAgKEVORyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxHT1ZFUk5NRU5UICAgICAgICAgICAgICAgICAgICAgKEdPViApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxISVNUT1JZICAgICAgICAgICAgICAgICAgICAgICAgKEhJUyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxMSUJFUkFMIFNUVURJRVMgICAgICAgICAgICAgICAgKE1MUyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxMSUJSQVJZIElORk9STUFUSU9OIFNDSUVOQ0UgICAgKExJUyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxNQVRIICAgICAgICAgICAgICAgICAgICAgICAgICAgKE1USCApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxQU1lDSE9MT0dZICAgICAgICAgICAgICAgICAgICAgKFBTWSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxTT0NJT0xPR1kgICAgICAgICAgICAgICAgICAgICAgKFNPQyApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxTUEFOSVNIICAgICAgICAgICAgICAgICAgICAgICAgKFNQQSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxTUEVFQ0ggICAgICAgICAgICAgICAgICAgICAgICAgKFNQRSApOz47Oz47Pj47Pj47dDw7bDxpPDE%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8QDxUSEVPTE9HWSAgICAgICAgICAgICAgICAgICAgICAgKFRIRSApOz47Oz47Pj47Pj47Pj47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOz47Oz47Pj47Pj47Pj47Pj47dDw7bDxpPDE%2BO2k8NT47aTw3PjtpPDk%2BO2k8MTA%2BO2k8MTQ%2BO2k8MTY%2BO2k8MTg%2BOz47bDx0PHA8O3A8bDxzaXplO29uZm9jdXM7b25ibHVyO29ua2V5ZG93bjs%2BO2w8MTI7aWYgKHRoaXMudmFsdWUgPT0gJ1NlYXJjaCBTdC4gSm9oblxcJ3MnKSB0aGlzLnZhbHVlID0gJydcOztpZiAodGhpcy52YWx1ZSA9PSAnJykgdGhpcy52YWx1ZSA9ICdTZWFyY2ggU3QuIEpvaG5cXCdzJ1w7O2lmICgoZXZlbnQud2hpY2ggJiYgZXZlbnQud2hpY2ggPT0gMTMpIHx8IChldmVudC5rZXlDb2RlICYmIGV2ZW50LmtleUNvZGUgPT0gMTMpKSB7dGhpcy5mb3JtLmVsZW1lbnRzWydfY3RsMDpfY3RsMDpGb290ZXIxOmJ1dEdvJ10uY2xpY2soKVw7cmV0dXJuIGZhbHNlXDt9IGVsc2UgcmV0dXJuIHRydWVcOyA7Pj4%2BOzs%2BO3Q8O2w8aTwxPjtpPDM%2BO2k8NT47aTw3Pjs%2BO2w8dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvdWlzO0xvZ2luIFVJUzs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L3N0dWRlbnRzL2ludHJhbmV0LnN0ajtTdC4gSm9obidzIEludHJhbmV0Oz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvY29udGFjdC5zdGo7Q29udGFjdCBVczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L2FsdW1uaS9naXZpbmc7R2l2aW5nIEJhY2s7Pj47Pjs7Pjs%2BPjt0PHA8bDxWaXNpYmxlOz47bDxvPGY%2BOz4%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7PjtsPC8jOz4%2BO3A8bDxvbmNsaWNrOz47bDx3aW5kb3cub3BlbignaHR0cDovL3d3dy5zdGpvaG5zLmVkdS9hY2FkZW1pY3MvY291cnNlcy5wcmludCcsJ3ByaW50Jywnd2lkdGg9NTAwLGhlaWdodD01MDAscmVzaXphYmxlPXllcyxzY3JvbGxiYXJzPXllcyx0b29sYmFyPXllcyxtZW51YmFyPXllcycpXDtyZXR1cm4gZmFsc2VcOzs%2BPj47bDxpPDA%2BOz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8aW1nIGlkPSJfY3RsMF9fY3RsMF9Gb290ZXIxX2ltZ1ByaW50IiBzcmM9Ii9pbWFnZXMvZm9vdGVyL3ByaW50SWNvbi5naWYiIGFsdD0iUHJpbnQiIHN0eWxlPSJib3JkZXItc3R5bGU6bm9uZVw7IHdpZHRoOjIwcHhcOyBoZWlnaHQ6MTBweFw7ICIgIC9cPjs%2BPjs7Pjs%2BPjs%2BPjt0PHA8cDxsPE5hdmlnYXRlVXJsOz47bDwvIzs%2BPjtwPGw8b25jbGljazs%2BO2w8d2luZG93Lm9wZW4oIm1haWx0bzo%2FU3ViamVjdD1JbnRlcmVzdGluZyUyMGl0ZW0lMjBmcm9tJTIwU3QuJTIwSm9obidzLi4uJkJvZHk9SSUyMHNhdyUyMHRoaXMlMjBwYWdlJTIwb24lMjB0aGUlMjBTdC4lMjBKb2huJ3MlMjBVbml2ZXJzaXR5JTIwV2ViJTIwc2l0ZSwlMjBhbmQlMjB0aG91Z2h0JTIweW91JTIwbWlnaHQlMjBiZSUyMGludGVyZXN0ZWQ6JTBhJTBhaHR0cCUzYSUyZiUyZnd3dy5zdGpvaG5zLmVkdSUyZmFjYWRlbWljcyUyZmNvdXJzZXMuc3RqIiwnbWFpbGFmcmllbmQnLCcnKVw7cmV0dXJuIGZhbHNlXDs7Pj4%2BO2w8aTwwPjs%2BO2w8dDw7bDxpPDA%2BOz47bDx0PHA8bDxUZXh0Oz47bDxcPGltZyBpZD0iX2N0bDBfX2N0bDBfRm9vdGVyMV9pbWdFbWFpbCIgc3JjPSIvaW1hZ2VzL2Zvb3Rlci9lbWFpbEljb24uZ2lmIiBhbHQ9IkUtbWFpbCBwYWdlIiBzdHlsZT0iYm9yZGVyLXN0eWxlOm5vbmVcOyB3aWR0aDoyOHB4XDsgaGVpZ2h0OjhweFw7ICIgIC9cPjs%2BPjs7Pjs%2BPjs%2BPjt0PHA8bDxUZXh0Oz47bDwyMDA3Oz4%2BOzs%2BO3Q8O2w8aTwxPjtpPDM%2BO2k8NT47aTw3PjtpPDk%2BO2k8MTE%2BO2k8MTM%2BO2k8MTU%2BOz47bDx0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC87SG9tZTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L3NpdGVtYXAuc3RqO1NpdGUgTWFwOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDxtYWlsdG86d2VibWFzdGVyQHN0am9obnMuZWR1P1N1YmplY3Q9U2l0ZSUyMEZlZWRiYWNrO0ZlZWRiYWNrOz4%2BOz47Oz47dDxwPHA8bDxOYXZpZ2F0ZVVybDtUZXh0Oz47bDwvcHJpdmFjeS5zdGo7UHJpdmFjeTs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L3NhZmV0eTtTYWZldHk7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9zdHVkZW50cy9zaG9wLnN0ajtTaG9wIFN0LiBKb2huJ3M7Pj47Pjs7Pjt0PHA8cDxsPE5hdmlnYXRlVXJsO1RleHQ7PjtsPC9mYWN1bHR5L2hyL3JlY3J1aXRtZW50O1dvcmsgYXQgU3QuIEpvaG4nczs%2BPjs%2BOzs%2BO3Q8cDxwPGw8TmF2aWdhdGVVcmw7VGV4dDs%2BO2w8L2ZhY3VsdHkvaHI7SHVtYW4gUmVzb3VyY2VzOz4%2BOz47Oz47Pj47dDxwPGw8VmlzaWJsZTs%2BO2w8bzxmPjs%2BPjs7Pjs%2BPjs%2BPjs%2BPjs%2BPjs%2BPjs%2BPjs%2BPjs%2BPjs%2B")
                            post3_val = do_post_back(deps_doc_main.at("#Form1"),s_link['href'],common,["_ctl0:_ctl0:_ctl0:Button1"])
                            raw_post  = post(post_url,post3_val)
                            course_doc = normalize(raw_post)
                            course_doc = course_doc.slice(/<table.*?DGCourses.*?<\/table>/)
                            if !course_doc
                                prompt level + " " + term + " " + campus
                                next 
                            end
                            course_doc = parse(course_doc)
                            course_doc.search("tr.Bulletin").each do |course_row|
                                cols = course_row.search("td")
                                cnum = normalize(cols[0].inner_text)
                                cname = normalize(cols[1].inner_text)
                                cc = normalize(cols[3].inner_text)
                                scode,cnum = cnum.split(" ",2)
                                get_subject(scode).get_course(cnum,cname,"",cc)                                
                            end 
                         end
                    end
                end
            end
            
        end
#        l1_post = "http://www.stjohns.edu/view.aspx?path=academics&view=courses"        
#        
        
    end
end
